# ════════════════════════════════════════════════════════════════════════════════
# Upstream Service Definitions
# ════════════════════════════════════════════════════════════════════════════════

# API Service
upstream template_business_api {
    least_conn;
    server template_business_api:8000 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Bot Service (for webhook mode)
upstream template_business_bot {
    server template_business_bot:8000 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

# PostgreSQL Data Service (direct access for admin/debugging)
upstream template_data_postgres_api {
    server template_data_postgres_api:8000 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

# MongoDB Data Service (direct access for admin/debugging)
upstream template_data_mongo_api {
    server template_data_mongo_api:8000 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

# RabbitMQ Management (optional)
upstream rabbitmq_management {
    server rabbitmq:15672;
}

# Prometheus (monitoring)
upstream prometheus {
    server prometheus:9090;
}

# Grafana (monitoring)
upstream grafana {
    server grafana:3000;
}
